<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="img-src https://*; media-src https://*;"
    />
    <meta name="description" content="A simple video slider with loading bar" />
    <meta name="keywords" content="video, slider, loading" />
    <meta name="omarmhawash" content="Vide Hero slider" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="style.keyframes.css" />

    <title>Vide Hero Slider</title>
  </head>
  <body>
    <div id="hero-video-slider">
      <div class="videos">
        <div class="video-item">
          <div class="video-wrapper">
            <video
              src="https://v4.cdnpk.net/videvo_files/video/free/video0467/large_watermarked/_import_6153fd7fb02b42.10914171_FPpreview.mp4"
              playsinline
              loop
              muted
            />
          </div>
          <div class="desc-shadow"></div>
          <div class="black-shadow"></div>
          <div class="hero-desc">
            <h1>Leaning Worker</h1>
            <p>
              Coffee truck worker leaning on the van while using a tablet, group
              of people talk and drink coffee in the background necessitatibus
              corrupti quo ratione, itaque dolore repellendus delectus incidunt
              animi eos eum sit officiis quia ab! Alias, quas labore? Impedit!
            </p>
            <button>Play ▶</button>
          </div>
        </div>
        <div class="video-item">
          <div class="video-wrapper">
            <video
              src="https://v4.cdnpk.net/videvo_files/video/free/video0482/large_watermarked/_import_62a032b814dcf3.17632143_FPpreview.mp4"
              playsinline
              loop
              muted
            />
          </div>
          <div class="desc-shadow"></div>
          <div class="black-shadow"></div>
          <div class="hero-desc">
            <h1>Truck Fleet</h1>
            <p>
              Bottom view of boss and worker organizing a truck fleet in a
              logistics park reiciendis magnam quidem consequuntur repellendus
              tempore harum porro veniam. Quas aspernatur voluptate repudiandae
              ad explicabo eos necessitatibus ut enim sequi ipsa!
            </p>
            <button>Play ▶</button>
          </div>
        </div>
        <div class="video-item">
          <div class="video-wrapper">
            <video
              src="https://v4.cdnpk.net/videvo_files/video/free/video0468/large_watermarked/_import_615e822f441630.29312117_FPpreview.mp4"
              playsinline
              loop
              muted
            />
          </div>
          <div class="desc-shadow"></div>
          <div class="black-shadow"></div>
          <div class="hero-desc">
            <h1>Blue Uniform</h1>
            <p>
              Male courier in blue uniform taking packages out of van and
              delivering it to blond woman waiting on front porch ullam nam
              doloremque adipisci doloribus beatae ad quae corrupti repellendus,
              ipsa atque impedit soluta sit? Explicabo reiciendis dignissimos
              nihil.
            </p>
            <button>Play ▶</button>
          </div>
        </div>
      </div>
      <button class="next-btn" onclick="nextVideo()">></button>
      <div class="loading-percent" />
    </div>
  </body>
  <script>
    const videoItems = document.getElementsByClassName("video-item");
    const nextBtn = document.getElementsByClassName("next-btn")[0];
    const videoTags = document.getElementsByTagName("video");
    const aBox = document.querySelector(".loading-percent");

    const videosLength = videoItems.length;
    const loopTime = 8000;
    let videoIdx = 0;
    let loadPer = 2;

    function hideVideos(showIndex) {
      for (let i = 0; i < videoItems.length; i++) {
        const rmTime =
          (videoTags[i].duration - videoTags[i].currentTime) * 1000;
        if (showIndex != i) {
          videoItems[i].style.display = "none";
          videoTags[i].pause();
          if (i > 0 && rmTime < loopTime) {
            videoTags[i].currentTime = 0;
            console.log(rmTime, loopTime);
          }
        } else {
          videoItems[i].style.display = "block";
          videoTags[i].play();
        }
      }
    }

    function loopVideos() {
      console.log("videos at", videoIdx);
      hideVideos(videoIdx);
      videoIdx = (videoIdx + 1) % videosLength;
    }
    function updateLoading() {
      aBox.style.cssText = `width:${loadPer}%`;
      loadPer = (loadPer + 0.1) % 100;
    }

    function nextVideo() {
      loopVideos();
      loadPer = 2;
    }

    hideVideos(0);
    loopVideos();
    setInterval(() => {
      loopVideos();
      loadPer = 2;
    }, loopTime);
    setInterval(() => {
      updateLoading();
    }, loopTime / 1000);
  </script>
</html>
